## 目标
- 扩展实现权限聚合、菜单管理与权限管理的完整后端接口与前端页面。
- 前端按用户权限动态控制菜单与按钮显隐，完成联调并启动可预览服务。

## 后端改造
- 权限聚合
  - 在认证流程中根据 `sys_user_role` → `sys_role_permission` → `sys_permission.perm_code` 聚合权限码，填充到 `UserDto.permissions`。
- 权限管理接口
  - 新增 `AdminPermissionController`：`GET/POST/PUT/DELETE /api/admin/permissions` 与详情，绑定 `@SaCheckPermission(sys:perm:*)`。
- 菜单管理接口
  - 新增 `AdminMenuController`：菜单树 `GET /api/admin/menus/tree`、详情、创建、更新、删除、（可选）绑定权限。
  - 提供树构建服务，支持目录/菜单/按钮类型，`enabled/hiddenMenu/orderNum` 等字段。
- 操作日志（可选）
  - AOP 记录写操作至 `sys_oper_log`。

## 前端改造
- 权限显隐
  - 新增 `usePerms()` 或工具 `can()`，从当前用户的 `permissions` 判断按钮与菜单显隐；缺权限自动隐藏或禁用。
- 动态菜单
  - `AppLayout` 在登录后请求 `/api/admin/menus/tree`，结合 `permissionHint` 与 `permissions` 过滤生成左侧菜单；路由保持当前页面结构（`/users`、`/roles`、`/menus`、`/permissions`）。
- 权限管理页面
  - 新增权限列表与创建编辑页，对接 `/api/admin/permissions`。
- 菜单管理页面
  - 新增菜单树管理页（增删改、排序），对接 `/api/admin/menus/*`。
- 角色分配权限 UI
  - 在角色页新增“分配权限”对话框，读 `GET /api/admin/permissions`，提交 `PUT /api/admin/roles/{id}/permissions`。
- 用户/角色页面的按钮显隐
  - 创建按钮需 `sys:user:create`、`sys:role:create`；其它操作按对应权限码控制。

## 联调与启动
- 后端：运行 `mvn spring-boot:run`，检查 Flyway 迁移成功、接口可用。
- 前端：`npm run dev`，打开 `http://localhost:5173`，完成登录、菜单加载与按钮显隐验证。
- 预览：提供前端预览地址与后端接口连通性验证清单。

## 验证清单
- 登录后 `UserDto.permissions` 包含角色聚合权限；切换角色后权限变化生效。
- 菜单树加载成功，受 `permissionHint` 与 `permissions` 控制显隐。
- 权限管理与菜单管理 CRUD 正常；角色分配权限后，按钮与菜单显隐实时生效（刷新后可见）。

## 交付
- 后端新增控制器与服务实现、前端页面与工具、联调通过后启动本地服务并提供预览链接。请确认，确认后我将立即实现并启动两端服务供预览。